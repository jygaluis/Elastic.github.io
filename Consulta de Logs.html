
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="JygaLogo.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.1">
    
    
      
        <title>Consulta de datos - Elastic Stack</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.23b6d78a.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#uso-de-kibana" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Elastic Stack" class="md-header__button md-logo" aria-label="Elastic Stack" data-md-component="logo">
      <img src="JygaLogo.png">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Elastic Stack
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Consulta de datos
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Elastic Stack" class="md-nav__button md-logo" aria-label="Elastic Stack" data-md-component="logo">
      <img src="JygaLogo.png">
    </a>
    Elastic Stack
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Previo%20a%20la%20instalacion.html" class="md-nav__link">
        Previo a la instalación del stack
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Elasticsearch
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Elasticsearch" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Elasticsearch
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Elasticsearch/Elasticsearch%20Instalaci%C3%B3n.html" class="md-nav__link">
        Instalación
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Elasticsearch/Elasticsearch%20Configuraci%C3%B3n.html" class="md-nav__link">
        Configuración
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Elasticsearch/Elasticsearch%20Implementaci%C3%B3n%20de%20seguridad.html" class="md-nav__link">
        Implementación de seguridad
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Kibana
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Kibana" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Kibana
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Kibana/Kibana%20Instalacion.html" class="md-nav__link">
        Instalación
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Kibana/Kibana%20Configuracion.html" class="md-nav__link">
        Configuración
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Kibana/Kibana%20Seguridad.html" class="md-nav__link">
        Llave de encriptación y conexión segura a Elasticsearch
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Logstash
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Logstash" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Logstash
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Logstash/Logstash%20Instalacion.html" class="md-nav__link">
        Instalación
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Logstash/Logstash%20Configuraci%C3%B3n.html" class="md-nav__link">
        Configuración
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Beats
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Beats" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Beats
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Beats/Beats%20Introduccion.html" class="md-nav__link">
        Introducción
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Beats/Beat%20Filebeat.html" class="md-nav__link">
        Filebeat
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="Beats/Beats%20Winlogbeat.html" class="md-nav__link">
        Winlogbeat
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Consulta de datos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Consulta%20de%20Logs.html" class="md-nav__link md-nav__link--active">
        Consulta de datos
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#consulta-de-indices" class="md-nav__link">
    Consulta de Indices
  </a>
  
    <nav class="md-nav" aria-label="Consulta de Indices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creacion-de-patron-de-indice" class="md-nav__link">
    Creación de patrón de indice
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consulta-de-logs" class="md-nav__link">
    Consulta de Logs
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="Mantenimiento%20del%20stack.html" class="md-nav__link">
        Mantenimiento del stack
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#consulta-de-indices" class="md-nav__link">
    Consulta de Indices
  </a>
  
    <nav class="md-nav" aria-label="Consulta de Indices">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creacion-de-patron-de-indice" class="md-nav__link">
    Creación de patrón de indice
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consulta-de-logs" class="md-nav__link">
    Consulta de Logs
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="uso-de-kibana">Uso de Kibana</h1>
<p>Por medio de Kibana se interactúa con los datos en Elasticsearch. Para entrar se escribe en el navegador la dirección del servidor donde se instaló y el puerto. Como se vió en la primera parte de la Arquietctura General para este proyecto es <code>10.91.116.215:5601</code>. Una vez dentro se piden credenciales, inicialmente se usan la de los usuarios <em>built-in</em>, despues se pueden crear adicionales.</p>
<p><img alt="Inicio Kibana" src="image9.png" /></p>
<p>Una vez dentro se presentan varios <em>widgets</em> con funcionalidades de Kibana, sin embargo es más fácil ubicar todas las opciones por medio del menu desplegable:</p>
<p><img alt="Inicio Kibana" src="image9.1.png" /></p>
<h2 id="consulta-de-indices">Consulta de Indices</h2>
<p>Cuando se configuró Logstash se vio que los indices se crean por sistema, host, nombre del servicio y se rotan cada mes, es decir, se creará uno nuevo al inicio del mes. Kibana cuenta con un apartado de herramientas de desarrollador para consumir la API de Elsaticsearch, del menu de navegación dar click en <em>Dev Tools</em></p>
<p><img alt="Inicio Kibana" src="image9.3.png" /></p>
<p>Si por ejemplo se envia <code>GET _cat/indices/</code></p>
<p><img alt="api elasticsearch" src="image9.4.png" /></p>
<p>En la parte derecha se ve el nombre de todos los indices que existen y que tienen la estructura que se mencionó anteriormente, resaltando que todos comienzan por el nombre del sistema al que pertenecen, entonces si se envía <code>GET _cat/indices/mcs*</code> se obtiene sólo los del MCS</p>
<p><img alt="patron mcs" src="image9.5.png" /></p>
<p>A lo anterior se le conoce como patrón de indices y Kibana se basa en ello para saber sobre qué indices buscar al realizar una consulta en la sección de <em>Discover</em></p>
<h3 id="creacion-de-patron-de-indice">Creación de patrón de indice</h3>
<p>Del menú desplegable seleccionar <em>Stack Management</em> / <em>Index Patterns</em> y dar click en <em>Creat index pattern</em></p>
<p><img alt="patron mcs" src="image9.6.png" /></p>
<p>Se ingresa el nombre del patrón que deberán cumplir los indices, sin haber escrito nada se puede ver que actualmente existen 87.</p>
<p><img alt="patron mcs" src="image9.7.png" /></p>
<p>Ahora al poner <code>mcs*</code> obtenemos sólo aquellos de ese sistema. Dar click en <em>Create index pattern</em>, como ya se había agregado (este y de todo los sistemas) aparece un error, pero para nuevos patrones no aparecerá.</p>
<p><img alt="patron mcs" src="image9.8.png" /></p>
<h2 id="consulta-de-logs">Consulta de Logs</h2>
<p>Del menú desplegable selecionar <em>Discover</em>, allí se podrá hacer la consulta de los logs con algunos filtros por default:
<img alt="Inicio Kibana" src="image9.2.png" /></p>
<p>donde:</p>
<ul>
<li>1: Nombre del patrón del indice. Con la configuración actual es lo mismo que buscar por sistema.</li>
<li>2: Campos disponibles que contiene cada documento. </li>
<li>3: Contenido del documento filtrado por campos</li>
<li>4: Filtro de tiempo</li>
</ul>
<p>Seleccionando algunos campos se tiene una mejor visualización de los documentos</p>
<p><img alt="Documento filtrado" src="image9.9.png" /></p>
<p>De ahí se obtiene logs de todo tipo, para filtrar sólo de tipo <code>error</code>, seleccionar <code>Add Filter</code> y agregar los siguientes datos</p>
<p><img alt="Filtro error" src="image9.10.png" /></p>
<p><img alt="Filtro error" src="image9.11.png" /></p>
<p>Y así con cualquier otro campo disponible, por ejemplo para un servicio en particular:</p>
<p><img alt="Filtro error" src="image9.12.png" />
<img alt="Filtro error" src="image9.13.png" /></p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="Beats/Beats%20Winlogbeat.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Winlogbeat" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Winlogbeat
            </div>
          </div>
        </a>
      
      
        
        <a href="Mantenimiento%20del%20stack.html" class="md-footer__link md-footer__link--next" aria-label="Next: Mantenimiento del stack" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Mantenimiento del stack
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.instant"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.c7dec7e7.min.js"}</script>
    
    
      <script src="assets/javascripts/bundle.da79ceb7.min.js"></script>
      
    
  </body>
</html>